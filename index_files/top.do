

 
document.write('<link rel="stylesheet" type="text/css" href="/resource/account/topBar/css/skin_dft_sky.css?20130916"/>');

var accountComm={init:function(e){var a=this;if(this.config={mode:e.mode,urlMail:e.urlMail,urlAddr:e.urlAddr,urlDrive:e.urlDrive,urlCal:e.urlCal,urlAdmin:e.urlAdmin,sid:gMain.sid||window.sid,username:e.username,userNumber:e.userNumber,adminType:e.adminType,usersmallimg:e.usersmallimg,userlargeimg:e.userlargeimg,showskin:e.MAIL_CONFIG_SKIN,showlang:e.MAIL_CONFIG_FACE,ssl:e.ssl||0,webPath:e.webPath,isExtMail:e.isExtMail||!1,lang:{mail:e.lang&&e.lang.mail?e.lang.mail:"邮箱",addr:e.lang&&e.lang.addr?e.lang.addr:"通讯录",drive:e.lang&&e.lang.drive?e.lang.drive:"网盘",cal:e.lang&&e.lang.cal?e.lang.cal:"日历",lookup:e.lang&&e.lang.lookup?e.lang.lookup:"查看",lookupMore:e.lang&&e.lang.lookupMore?e.lang.lookupMore:"查看全部",setNow:e.lang&&e.lang.setNow?e.lang.setNow:"立即设置",modPwd:e.lang&&e.lang.modPwd?e.lang.modPwd:"修改密码",manage:e.lang&&e.lang.manage?e.lang.manage:"管理平台",modify:e.lang&&e.lang.modify?e.lang.modify:"修改",account:e.lang&&e.lang.account?e.lang.account:"账户管理",skin:e.lang&&e.lang.skin?e.lang.skin:"换肤",language:e.lang&&e.lang.language?e.lang.language:"语言设置",exit:e.lang&&e.lang.exit?e.lang.exit:"退出"},power:{mail:e.power&&e.power.mail,disk:e.power&&e.power.disk,cal:e.power&&e.power.cal,addr:e.power&&e.power.addr,account_center:e.power&&e.power.account_center,device:e.power&&e.power.device,pwdback:e.power&&e.power.pwdback,phonebind:e.power&&e.power.phonebind,pwdmodify:e.power&&e.power.pwdmodify,alias:e.power&&e.power.alias}},this.isShowAccountCenter=this.config.power.pwdback||this.config.power.pwdmodify||this.config.power.alias||this.config.power.phonebind,""==e.rid){var n=this.getUrlParamValue(location.href,"r");this.config.rid=n}else this.config.rid=e.rid;this.createTop(),this.createPanel();var i=document.getElementById("account_info"),s=document.getElementById("account_panel");if(window.calcAccountInfoPosition=setInterval(function(){if("function"==typeof window.jQuery&&jQuery("#account_info").length>0){var e=jQuery("#account_info");if(e.offset().left>0){var a=jQuery(document.body).width()-(e.offset().left+e.width());jQuery("#account_panel").css("right",(a||0)+"px"),clearInterval(window.calcAccountInfoPosition)}}},50),s.onmouseover=i.onmouseover=function(e){jQuery(i).addClass("cur"),s.style.display="block",a.stopPropagation(e)},i.onmouseout=s.onmouseout=function(e){s.style.display="none",jQuery("#account_info").removeClass("cur"),a.stopPropagation(e)},!this.config.isExtMail){var o=document.getElementById("messageCenter");o.getElementsByTagName("span")[0];var t=document.getElementById("messageCenter"),l=document.getElementById("messageDetail");l.onmouseover=o.onmouseover=function(e){var n=jQuery("#messageCenter").offset().left;return width_center=jQuery("#messageCenter").innerWidth(),width_detail=jQuery("#messageDetail").innerWidth(),left_detail=n+width_center-width_detail-2,e=e||window.event,(9==document.documentMode||10==document.documentMode)&&(left_detail=parseInt(left_detail,10),left_detail+=1),jQuery("#messageCenter").addClass("cur"),jQuery("#messageDetail").css("left",left_detail).show(),clearTimeout(a.newsTimer),a.initMessageEvent(),a.stopPropagation(e),e.preventDefault&&e.preventDefault(),!1},o.onmouseout=function(){},l.onmouseout=t.onmouseout=function(e){a.newsTimer=window.setTimeout(function(){jQuery("#messageCenter").closest("li").removeClass("cur"),l.style.display="none"},20),e=e||window.event,e.preventDefault?(e.preventDefault(),e.stopPropagation()):(e.returnValue=!1,e.cancelBubble=!0)},a.loadAllNews(),setInterval(function(){a.loadAllNews()},6e4)}},loadAllNews:function(){function e(e){var n=a.getLis(e);document.getElementById("btnIgnoreAll").style.display=/data-close="close"/g.test(n)?"inline":"none",document.getElementById("messageDetail").getElementsByTagName("ul")[0].innerHTML=n}var a=this,n="",i={},s="";window.fnSuc_getNews=function(a){var a=a["var"];a&&e(a)},n=location.protocol+"//"+location.host+a.config.webPath+"/service/common/common.do?func=common:GetUserMessage&messageState=0&sid="+a.config.sid+"&callback=fnSuc_getNews&userId="+a.userId,i={};var o=document.getElementsByTagName("head")[0];a.loadScript(n,null,null,o),s=function(){}},getOP:function(e){var a=["i-tMial"," i-tCloud"," i-tCanlen","i-tCrit"],n={};switch(e){case 0:n.className=a[0],n.url="###";break;case 1:n.className=a[1],n.url="###";break;case 2:n.className=a[2],n.url="###";break;case 3:n.className=a[3],n.url="###";break;case 4:n.className=a[1],n.url="###";break;default:n.className="",n.url="###"}return n},setNewsNumTip:function(){var e=null;p=this,num=p.newsLength||0,e=document.getElementById("news_num"),e.innerHTML=num},getLis:function(e){function a(e,a){var n=[],s={mode:"",text:""};switch(e){case 3:switch(a){case 0:s.mode="Pass",s.text=i.config.lang.modPwd;break;case 1:s.mode="PassSec",s.text=i.config.lang.setNow;break;default:}break;default:}return(i.config.power.pwdback||"PassSec"!=s.mode)&&n.push('(<a href="'+i.getSSLUrl(i.config.urlMail+"/se/account/accountindex.do?sid="+i.config.sid+"&mode="+s.mode,"pannel")+'">'+s.text+"</a>)"),s.text?n.join(""):""}for(var n=[],i=this,s=0,o=0,t="",l=[],r=0,c=e.length;c>r;r++){var d=parseInt(e[r].messageFrom,10),u=parseInt(e[r].messageType,10),g=e[r].id,p=e[r].messageInfo.title,m=e[r].messageInfo.content,f=i.getOP(d),h=f.url,w=f.className;p&&(m=p),"0"==d?(t=e[r].messageInfo?e[r].messageInfo.content:"",s=1):5>o&&(n.push("<li>"),n.push('<div class="topNews-div">'),n.push('<a data-type="close-ohter"  data-messageFrom="'+d+'"   data-messageType="'+u+'" data-id="'+g+'" href="'+h+'" data-close="close" class="tClose"></a>'),n.push('<i class="'+w+' ico-lt"></i>'),n.push('<p class="topnews-rt">'),n.push(m),n.push(a(d,u)),n.push("</p>"),n.push("</div>"),n.push("</li>"),o++)}return s?(l.push("<li>"),l.push('<div class="topNews-div">'),l.push('<i class="i-tMial ico-lt" ico-lt"></i>'),l.push('<p class="topnews-rt">'),l.push(t),"MAIL"==this.config.mode.toUpperCase()?l.push('<a href="###" id="readUnRead">('+i.config.lang.lookup+")</a>"):l.push('<a href="'+this.config.urlMail+"/se/mail/m.do?&opType=goUnRead&sid="+this.config.sid+"&from="+this.config.mode.toUpperCase()+' ">('+i.config.lang.lookup+")</a>"),l.push("</p>"),l.push("</div>"),l.push("</li>"),i.newsLength=e.length):i.newsLength=e.length,i.setNewsNumTip(),n=l.join("")+n.join("")},goUnReadMail:function(){jQuery("#leftMenu_newMailCount_sys1").click()},initMessageEvent:function(){function e(e){var n="",i=jQuery(e).attr("data-type"),s="";window.fnSuc_updataNews=function(){a.loadAllNews()},n=location.protocol+"//"+location.host+a.config.webPath+"/service/common/common.do?func=common:UpdateUserMessage"+"&callback=fnSuc_updataNews"+"&messageState=1"+"&sid="+a.config.sid,"close-unRead"==i?n+="&messageFrom=0":("undefined"!==jQuery(e).attr("data-id")&&(n+="&id="+jQuery(e).attr("data-id")),"undefined"!==jQuery(e).attr("data-messageFrom")&&(n+="&messageFrom="+jQuery(e).attr("data-messageFrom")),"undefined"!==jQuery(e).attr("data-messageType")&&(n+="&messageType="+jQuery(e).attr("data-messageType"))),s=function(){};var o=document.getElementsByTagName("head")[0];a.loadScript(n,null,s,o)}var a=this,n=jQuery;n("#messageDetail").unbind().delegate("[data-close]","click",function(){return e(this),!1}),n("#readUnRead").unbind().bind("click",function(){return parent.CC&&parent.CC.receiveMail(),!1})},loadScript:function(e,a,n,i,s,o){var t,l=s||"js",r=new Date,c=r.getTime();"js"===l&&(t=document.createElement("script"),t.type="text/javascript",t.src=e+"&tid="+c,t.async="true",o&&(t.charset=o)),t.onload=t.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(a&&a(),t.onload=t.onreadystatechange=null)},t.onerror=function(){n&&n(),t.onerror=null},i.appendChild(t)},doService:function(e,a,n,i,s){jQuery.ajax({type:s||"POST",url:e||"",data:JSON.stringify(a),dataType:"json",contentType:"text/javascript; charset=UTF-8",success:n,error:i})},createTop:function(){function e(e){var a=e.childNodes[0];3==e.childNodes[0].nodeType&&(a=e.childNodes[1]);var n=a.className;e.onmouseover=function(){-1==n.indexOf("on")&&(a.className=a.className+" on")},e.onmouseout=function(){a.className=n}}var a='<ul class="topBar-ul">';this.config.power.mail&&(a+="mail"!=this.config.mode.toLowerCase()?' <li><a href="'+this.getSSLUrl(this.config.urlMail+"/se/mail/m.do?sid="+this.config.sid+"&from="+this.config.mode.toUpperCase()+"&r="+this.config.rid,"top")+'" class="navbar-a"><span>'+this.config.lang.mail+"</span></a></li>":'<li class="on"><a href="javascript:void(0);" class="navbar-a"><span>'+this.config.lang.mail+"</span></a></li>"),this.config.power.addr&&(a+="addr"!=this.config.mode.toLowerCase()?' <li><a href="'+this.getSSLUrl(this.config.urlAddr+"/addr.do?sid="+this.config.sid+"&from="+this.config.mode.toUpperCase()+"&r="+this.config.rid,"top")+'" class="navbar-a"><span>'+this.config.lang.addr+"</span></a></li>":'<li class="on"><a href="javascript:void(0);" class="navbar-a"><span>'+this.config.lang.addr+"</span></a></li>"),this.config.power.disk&&(a+="drive"!=this.config.mode.toLowerCase()?' <li><a href="'+this.getSSLUrl(this.config.urlDrive+"/ssologin.do?sid="+this.config.sid+"&from="+this.config.mode.toUpperCase()+"&r="+this.config.rid,"top")+'" class="navbar-a"><span>'+this.config.lang.drive+"</span></a></li>":'<li class="on"><a href="javascript:void(0);" class="navbar-a"><span>'+this.config.lang.drive+"</span></a></li>"),this.config.power.cal&&(a+="cal"!=this.config.mode.toLowerCase()?' <li><a href="'+this.getSSLUrl(this.config.urlCal+"/cal/index.do?sid="+this.config.sid+"&from="+this.config.mode.toUpperCase()+"&r="+this.config.rid,"top")+'" class="navbar-a"><span>'+this.config.lang.cal+"</span></a></li>":'<li class="on"><a href="javascript:void(0);" class="navbar-a"><span>'+this.config.lang.cal+"</span></a></li>"),a+="</ul>";var n="mail"==this.config.mode.toLowerCase()?' style="display:none;z-index: 2010;"':'style="z-index: 2010;"',i='<div class="navbar-position" id="accountbar"'+n+">";i+='<div class="top-navbar">',i+=a,i+='<ul class="topBar-ul" style="float:right;" id="account_list">',this.config.isExtMail||(i+='<li id="messageCenter"><a id="messageCenter" href="javascript:void(0);" class="navbar-a"><span class="disWrap"><i class="i-news"></i><var class="news-num" id="news_num">0</var></span></a></li>'),this.config.adminType>0&&(i+="admin"!=this.config.mode.toLowerCase()?'<li><a class="navbar-a" href="'+this.getSSLUrl(this.config.urlAdmin+"/home.do?sid="+this.config.sid+"&from="+this.config.mode.toUpperCase()+"&r="+this.config.rid,"pannel")+'" ><span>'+this.config.lang.manage+"</span></a>":'<li><a class="navbar-a" href="javascript:void(0);"><span>'+this.config.lang.manage+"</span></a>",i+="</li>"),this.config.showskin&&(i+='<li><a href="'+this.getSSLUrl(this.config.urlMail+"/se/account/accountindex.do?sid="+this.config.sid+"&mode=Skin&from="+this.config.mode.toUpperCase()+"&r="+this.config.rid,"pannel")+'" class="navbar-a"><span>'+this.config.lang.skin+"</span></a></li>"),i+='<li id="account_info"><a href="javascript:;" class="navbar-a"><i class="i-acount mr_5"></i><span>'+this.config.username+'</span><i class="i-caret ml_5"></i></a></li>',i+='<li><a href="'+this.config.urlMail+"/login/logout.do?sid="+this.config.sid+"&from="+this.config.mode.toUpperCase()+"&r="+this.config.rid+'" class="navbar-a"><span>'+this.config.lang.exit+"</span></a></li>",i+="</ul>",i+="</div>",document.write(i);for(var s=document.getElementById("account_list").getElementsByTagName("li"),o=0;s.length>o;o++){var t=s[o];e(t)}},createPanel:function(){function e(e){var a=e.className||"";e.onmouseover=function(){return e.className=e.className+" on",!1},e.onmouseout=function(){return e.className=a,!1}}var a=this,n="";a.config.isExtMail||(n+='<div id="messageDetail" style="width:300px; display:none; " class="topBar-pop">',n+='<ul class="topNewsList"></ul>',n+='<div class="tMore"><a id="lookup_more" href="'+this.config.urlMail+"/se/message/message.do?sid="+this.config.sid+'&mode=allNews">查看全部</a><a class="ml_20" href="javascript:;" id="btnIgnoreAll">忽略全部</a></div>',n+="</div>"),n+="</div>",n+='<div id="account_panel" class="aco_pop clearfix" style="display:none;top:29px;right:76px;z-index:20500">',n+='<div class="noflow aco_pop_r" style="margin-left: 0;">',n+='<ul class="search-ulone">',n+=' <li><i class="i-selected mr_10"></i><span class="inblock-mid">'+this.config.userNumber+"</span></li>",n+="</ul>",a.isShowAccountCenter&&(n+='<div class="aco_pis">',(this.config.power.phonebind||this.config.power.pwdback||this.config.power.pwdmodify||this.config.power.alias)&&(n+='<p><a href="'+this.getSSLUrl(this.config.urlMail+"/se/account/accountindex.do?sid="+this.config.sid+"&mode=Index&from="+this.config.mode.toUpperCase()+"&r="+this.config.rid,"pannel")+'">'+this.config.lang.account+"</a></p>"),a.config.power.device&&(n+='<p><a href="'+this.getSSLUrl(this.config.urlMail+"/se/account/accountindex.do?sid="+this.config.sid+"&mode=Device&from="+this.config.mode.toUpperCase()+"&r="+this.config.rid,"pannel")+'" class="popul_a">设备管理</a></p>'),n+="</div>"),n+="</div></div>",document.write(n);for(var i=document.getElementById("account_panel").getElementsByTagName("li"),s=0;i.length>s;s++){var o=i[s];e(o)}document.getElementById("btnIgnoreAll").onclick=function(){var e=gMain.webPath||gMain.urlYaddr||"undefined"!=typeof mailUrl&&mailUrl||"/webmail",n=e+"/service/common/common.do?func=common:UpdateUserMessageBatch",i=gMain.sid||sid;n+="&sid="+i+"&rnd="+Math.random(),jQuery.ajax({url:n,type:"POST",data:{},complete:function(){a.loadAllNews()}})}},stopPropagation:function(e){var e=e||window.event;e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},getUrlParamValue:function(e,a){var n=RegExp("(^|&|\\?|\\s)"+a+"\\s*=\\s*([^&]*?)(\\s|&|$)","i"),i=n.exec(e);return i?i[2].replace(/[\x0f]/g,";"):""},getSSLUrl:function(e,a){if(-1==e.indexOf("http")){var n=location.port;("http"==location.protocol&&"80"==n||"https"==location.protocol&&"443"==n)&&(n=""),e=location.protocol+"//"+location.host+e}var i=e.indexOf("://"),s=e.substring(0,i),o=e.substring(i),t=this.config.ssl-0;return s="top"==a?3==t?"https":"http":"pannel"==a?t>0?"https":"http":"http",s+o}};
/*
* 顶部页面菜单加载完后, 初始化菜单
*/
var isExtMail = 'false' == 'true' ? true : false;
var closeAdminLink = '0';
accountComm.init({
    mode:'MAIL',
    urlMail:"/webmail",
    urlAddr:"/webmail",
    webPath:"/webmail",
    urlDrive:"/drive",
    urlCal:"/calendar/se",
    urlAdmin:"/webadmin",
    rid:'3c1bb5aad45c423fbf1bfc8fd434c857',
    username:"关志勇" || "zhiyong-guan",
    userNumber:'zhiyong-guan@chd.com.cn',
     adminType:(1==closeAdminLink?'0':'0'),
    usersmallimg:"/resource/account/images/top_people.jpg",
    userlargeimg:"/resource/account/images/upload_p.jpg",
    urlResource:"/resource",
    MAIL_CONFIG_SKIN:true,
    MAIL_CONFIG_FACE:false, //false,
    MAIL_CONFIG_PHONEBIND:true,
    CENTER_EQUIPMENT:true,
    CENTER:true,
    skinName:"skin_dft_sky",
    ssl:"0",
    isExtMail: isExtMail,
    power:{
        cal:true,
        disk:false,
        addr:false,
        mail:true,
        account_center: true,
        device: true,
        pwdback: true,
        phonebind: true,
        pwdmodify: true,
        alias: false
    },
    lang:{
        mail:'邮箱',
        addr:'通讯录',
        drive:'网盘',
        cal:'日历',
        manage:'管理平台',
        modify:'修改',
        account:'帐户管理',
        skin:'换肤',
        language:'语言设置',
        exit:'退出',
    		lookup: '查看',
    		lookupMore: '查看更多',
    		setNow : '立即设置',
    		modPwd : '修改密码'
    }
});



